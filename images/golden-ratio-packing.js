function goldenratiopackingMain(){this.version='0.82';w=360;h=400;var s="";s+='<div style="position:relative; width:'+ w+'px; height:'+ h+'px; border-radius: 10px;  margin:auto; display:block; border: 2px solid #def;">';s+='<canvas id="canvasId" width="'+ w+'" height="'+ h+'" style="z-index:100;"></canvas>';s+='<div style="display: block; position: absolute; left:0; top:0; width:96%; padding:2%; text-align: center; background-color: #def; z-index: 20;">';s+='<div style="display: inline-block; font: bold 14px Arial;  text-align:center;" >Rotation Each Time:</div>';s+='<input id="dtheta" style="width:80px; font: bold 16px Arial; padding:3px; margin: 3px; text-align:center;  z-index:2;" value="0.333"  />';s+='<button id="goBtn" style="color: #000aae; font-size: 14px;" class="togglebtn"  onclick="goBtn()" >Go</button>';s+='<button id="stopBtn" style="color: #000aae; font-size: 14px;" class="togglebtn"  onclick="stopBtn()" >Stop</button>';s+='</div>';s+='<div id="copyrt" style="font: 10px Arial; font-weight: bold; color: #6600cc;  text-align:right;">&copy; 2015 MathsIsFun.com  v'+ this.version+'</div>';s+='</div>';document.write(s);el=document.getElementById('canvasId');ratio=2;el.width=w*ratio;el.height=h*ratio;el.style.width=w+"px";el.style.height=h+"px";g=el.getContext("2d");g.setTransform(ratio,0,0,ratio,0,0);maxPoints=200;p=this;this.image=new Image();this.image.onload=function(){p.wd=this.width;p.ht=this.height;update();};this.image.src='images/seed2.gif';}
function update(){g.clearRect(0,0,el.width,el.height);g.beginPath();g.fillStyle='#111';g.rect(0,40,el.width,el.height- 30);g.fill();dtheta=parseFloat(document.getElementById('dtheta').value);dt=2*Math.PI*dtheta;if(isNaN(dtheta))return;if(dtheta==0)return;r1=4.2;dr=3;rad=0;theSize=3;ptArr=[];theta=0;console.log("dtheta",dtheta,dt);xc=w/2;yc=40+(h- 40)/ 2;
animQ=true;doAnim();}
function doAnim(){rad+=theSize;do{var x=xc+ rad*Math.cos(theta);var y=yc+ rad*Math.sin(theta);gap=minDist(x,y)- theSize*2;if(gap>2){rad-=gap/2;}else{rad-=1;}}while(gap>0);ptArr.push([x,y]);var scale=theSize*3.2;transPaint(g,this.image,theta+ r1,x,y,67,67,scale/100);theta+=dt;theSize+=0.05;prevx=x;prevy=y;var dOut=60;if(y<-dOut)animQ=false;if(y>h+dOut)animQ=false;if(x<-dOut)animQ=false;if(x>w+dOut)animQ=false;if(ptArr.length>=maxPoints)animQ=false;if(animQ)
requestAnimationFrame(doAnim);}
function minDist(xn,yn){var min=1000;if(ptArr.length==0)return 0;for(var i=0;i<ptArr.length;i++){var d=dist(ptArr[i][0]- xn,ptArr[i][1]- yn);if(d<min)min=d;}
return min;}
function transPaint(g,image,angleInRad,positionX,positionY,wd,ht,size){g.translate(positionX,positionY);g.rotate(angleInRad);g.drawImage(image,-wd*size/2,-ht*size/2,wd*size,ht*size);g.rotate(-angleInRad);g.translate(-positionX,-positionY);}
function dist(dx,dy){return(Math.sqrt(dx*dx+ dy*dy));}
function goBtn(){update();}
function stopBtn(){animQ=false;}